{% extends 'biblioteca_core/base.html' %}
{% block content %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Lista de Livros</h1>
        {% if user.is_staff %}
            <a href="{% url 'livro-create' %}" class="btn btn-success">Adicionar Livro</a>
        {% endif %}
    </div>

    <form method="get" class="mb-4">
        <div class="input-group">
            <input type="text" class="form-control" name="q" placeholder="Buscar por tÃ­tulo ou autor..." value="{{ request.GET.q|default_if_none:'' }}">
            <button class="btn btn-outline-primary" type="submit">Buscar</button>
        </div>
    </form>

    <div class="list-group">
        {% for livro in livros %}
            <div class="list-group-item list-group-item-action">
                <div class="row align-items-center">
                    <div class="col-md-1 col-3">
                        <a href="{{ livro.get_absolute_url }}">
                        {% if livro.capa %}
                            <img src="{{ livro.capa.url }}" class="img-fluid rounded" alt="Capa de {{ livro.titulo }}">
                        {% else %}
                             <div class="bg-secondary" style="width: 60px; height: 90px; border-radius: 4px;"></div>
                        {% endif %}
                        </a>
                    </div>
                    <div class="col-md-8 col-6">
                        <h5 class="mb-1"><a href="{{ livro.get_absolute_url }}" class="text-decoration-none text-dark">{{ livro.titulo }}</a></h5>
                        <p class="mb-1 text-muted">{{ livro.autor }}</p>
                    </div>
                    <div class="col-md-3 col-3 text-end">
                        {% if user.is_staff %}
                            <a href="{% url 'livro-update' livro.id %}" class="btn btn-sm btn-warning">Editar</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% empty %}
            <li class="list-group-item">Nenhum livro encontrado.</li>
        {% endfor %}
    </div>
{% endblock %}